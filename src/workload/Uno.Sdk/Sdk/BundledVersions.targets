<Project>

    <!-- 
      https://github.com/dotnet/designs/blob/main/accepted/2020/workloads/workload-manifest.md#library-packs
      The design document does not recommend implicit PackageReferences.
      Moreover, MAUI refuses this too - https://github.com/dotnet/maui/blob/main/src/Workload/Microsoft.Maui.Sdk/Sdk/BundledVersions.in.targets#L73
      It's there for now, but we have to take it into account.
    -->

    <PropertyGroup Label="Versions">
        <!-- Common -->
        <UnoVersion Condition=" '$(UnoVersion)' == '' ">4.10.26</UnoVersion>
        <UnoResizetizerVersion Condition=" '$(UnoResizetizerVersion)' == '' ">1.1.3</UnoResizetizerVersion>
        <UnoExtensionsVersion Condition=" '$(UnoExtensionsVersion)' == '' ">1.6.0</UnoExtensionsVersion>
        <MicrosoftExtensionsLoggingConsoleVersion Condition=" '$(MicrosoftExtensionsLoggingConsoleVersion)' == '' ">7.0.0</MicrosoftExtensionsLoggingConsoleVersion>
        
        <!-- It still using? -->
        <UnoCoreExtensionsLoggingSingletonVersion Condition=" '$(UnoCoreExtensionsLoggingSingletonVersion)' == '' ">4.0.1</UnoCoreExtensionsLoggingSingletonVersion>

        <!-- Skia -->
        <SkiaVersion Condition=" '$(SkiaVersion)' == '' ">2.88.6</SkiaVersion>

        <!-- WebAssembly -->
        <MicrosoftWindowsCompatibilityVersion Condition=" '$(MicrosoftWindowsCompatibilityVersion)' == '' ">7.0.5</MicrosoftWindowsCompatibilityVersion>
        <UnoWasmBootstrapVersion Condition=" '$(UnoWasmBootstrapVersion)' == '' ">7.0.29</UnoWasmBootstrapVersion>

        <!-- Windows -->
        <MicrosoftWindowsAppSDKVersion Condition=" '$(MicrosoftWindowsAppSDKVersion)' == '' ">1.4.230913002</MicrosoftWindowsAppSDKVersion>
        <MicrosoftWindowsSDKBuildToolsVersion Condition=" '$(MicrosoftWindowsSDKBuildToolsVersion)' == '' ">10.0.25936-preview</MicrosoftWindowsSDKBuildToolsVersion>

        <!-- Mobile -->
        <UnoUniversalImageLoaderVersion Condition=" '$(UnoUniversalImageLoaderVersion)' == '' ">1.9.36</UnoUniversalImageLoaderVersion>
        <XamarinGoogleAndroidMaterialVersion Condition=" '$(XamarinGoogleAndroidMaterialVersion)' == '' ">1.9.0.3</XamarinGoogleAndroidMaterialVersion>
    </PropertyGroup>
    
    <PropertyGroup>
        <!--
          If opted into NuGet Central Package Management, $(DisableUnoImplicitPackageReferences) defaults to true
          https://learn.microsoft.com/nuget/consume-packages/Central-Package-Management
        -->
        <DisableUnoImplicitPackageReferences Condition=" '$(ManagePackageVersionsCentrally)' == 'true' and '$(DisableUnoImplicitPackageReferences)' == '' ">true</DisableUnoImplicitPackageReferences>
    </PropertyGroup>

    <!--
      These implicit <PackageReference/> pull dependencies from NuGet transitively.
      They are first added to the <_UnoImplicitPackageReference/> item group to list the the desired
      packages. Then the packages that were specified by the user are removed from the list. Finally,
      the remaining implicit packages are added into the project.
  
      This logic only installs packages if and only if $(DisableUnoImplicitPackageReferences) is not
      true. This property allows the user to totally override all the default nugets installed. This
      should not be needed as the $(UnoVersion) should be sufficient. However, there may be a case
      to test various CI builds of .NET Uno.
    -->
    <ItemGroup Condition=" '$(DisableUnoImplicitPackageReferences)' != 'true' ">
<!--        <_UnoImplicitPackageReference Include="Uno.Resizetizer" Version="$(UnoResizetizerVersion)" PrivateAssets="all" Condition=" '$(UseUnoAssets)' == 'true' " />-->
<!--        <_UnoImplicitPackageReference Include="Uno.WinUI" Version="$(UnoVersion)" Condition=" '$(UseUno)' == 'true' ">-->
<!--            <PrivateAssets Condition=" '$(OutputType)' == 'Library' and '$(AndroidApplication)' != 'true' ">all</PrivateAssets>-->
<!--        </_UnoImplicitPackageReference>-->
    </ItemGroup>
    
    <!-- Install the nuget packages if we are allowed to -->
    <ItemGroup Condition=" '$(DisableUnoImplicitPackageReferences)' != 'true' ">
        <_UnoImplicitPackageReference Remove="@(PackageReference)" />
        <PackageReference Include="@(_UnoImplicitPackageReference)" IsUnoImplicitPackageReference="true" />
        <_UnoImplicitRequiredPackageReference Include="@(_UnoImplicitPackageReference->WithMetadataValue('IsUnoImplicitOptionalPackageReference',''))" />
    </ItemGroup>
    
    <!-- 
      It is also worth noting that MAUI starting with net8.0 abandoned implicit packages by default.
      There are reasons for this, but we're trying to leave it at that for now.
      https://github.com/dotnet/maui/blob/main/src/Workload/Microsoft.Maui.Sdk/Sdk/BundledVersions.in.targets#L63
    -->

    <ItemGroup>
        <PackageVersion Include="Microsoft.Extensions.Logging.Console" Version="$(MicrosoftExtensionsLoggingConsoleVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Microsoft.Windows.Compatibility" Version="$(MicrosoftWindowsCompatibilityVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Microsoft.Windows.SDK.BuildTools" Version="$(MicrosoftWindowsSDKBuildToolsVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Microsoft.WindowsAppSDK" Version="$(MicrosoftWindowsAppSDKVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="SkiaSharp.Skottie" Version="$(SkiaVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="SkiaSharp.Views.Uno.WinUI" Version="$(SkiaVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.Core.Extensions.Logging.Singleton" Version="$(UnoCoreExtensionsLoggingSingletonVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.Extensions.Logging.OSLog" Version="$(UnoExtensionsVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.Extensions.Logging.WebAssembly.Console" Version="$(UnoExtensionsVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.Resizetizer" Version="$(UnoResizetizerVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.UniversalImageLoader" Version="$(UnoUniversalImageLoaderVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.Wasm.Bootstrap" Version="$(UnoWasmBootstrapVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.Wasm.Bootstrap.DevServer" Version="$(UnoWasmBootstrapVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.Wasm.Bootstrap.Server" Version="$(UnoWasmBootstrapVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.WinUI" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.WinUI.RemoteControl" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.WinUI.Skia.Gtk" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.WinUI.WebAssembly" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Uno.UI.Adapter.Microsoft.Extensions.Logging" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
        <PackageVersion Include="Xamarin.Google.Android.Material" Version="$(XamarinGoogleAndroidMaterialVersion)" IsImplicitlyDefined="true" />
    </ItemGroup>

    <ItemGroup Condition="'$(UseUnoLibrary)' == 'true'">
        <PackageReference Include="Uno.WinUI" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.Resizetizer" Version="$(UnoResizetizerVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Microsoft.Extensions.Logging.Console" Version="$(MicrosoftExtensionsLoggingConsoleVersion)" IsImplicitlyDefined="true" />
    </ItemGroup>

    <ItemGroup Condition="'$(UseUnoMobile)' == 'true'">
        <PackageReference Include="Uno.Resizetizer" Version="$(UnoResizetizerVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.WinUI" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Microsoft.Extensions.Logging.Console" Version="$(MicrosoftExtensionsLoggingConsoleVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.Extensions.Logging.OSLog" Version="$(UnoExtensionsVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.UI.Adapter.Microsoft.Extensions.Logging" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.WinUI.RemoteControl" Condition="'$(Configuration)'=='Debug'" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
    </ItemGroup>

    <Choose>
        <When Condition="$([MSBuild]::GetTargetPlatformIdentifier('$(TargetFramework)')) == 'android'">
            <ItemGroup>
                <PackageReference Include="Xamarin.Google.Android.Material" Version="$(XamarinGoogleAndroidMaterialVersion)" IsImplicitlyDefined="true" />
                <PackageReference Include="Uno.UniversalImageLoader" Version="$(UnoUniversalImageLoaderVersion)" IsImplicitlyDefined="true" />
            </ItemGroup>
        </When>
        <When Condition="$([MSBuild]::GetTargetPlatformIdentifier('$(TargetFramework)')) == 'ios'">
        </When>
        <When Condition="$([MSBuild]::GetTargetPlatformIdentifier('$(TargetFramework)')) == 'maccatalyst'">
        </When>
    </Choose>

    <ItemGroup Condition="'$(UseUnoSkia)' == 'true'">
        <PackageReference Include="Uno.Resizetizer" Version="$(UnoResizetizerVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.WinUI.Skia.Gtk" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Microsoft.Extensions.Logging.Console" Version="$(MicrosoftExtensionsLoggingConsoleVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="SkiaSharp.Views.Uno.WinUI" Version="$(SkiaVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="SkiaSharp.Skottie" Version="$(SkiaVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.WinUI.RemoteControl" Version="$(UnoVersion)" IsImplicitlyDefined="true" Condition="'$(Configuration)'=='Debug'" />
        <PackageReference Include="Uno.UI.Adapter.Microsoft.Extensions.Logging" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
    </ItemGroup>

    <ItemGroup Condition="'$(UseUnoWebAssembly)' == 'true'">
        <PackageReference Include="Uno.Resizetizer" Version="$(UnoResizetizerVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Microsoft.Windows.Compatibility" Version="$(MicrosoftWindowsCompatibilityVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.Wasm.Bootstrap" Version="$(UnoWasmBootstrapVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.Wasm.Bootstrap.DevServer" Version="$(UnoWasmBootstrapVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.WinUI.WebAssembly" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.WinUI.RemoteControl" Version="$(UnoVersion)" Condition="'$(Configuration)'=='Debug'" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.UI.Adapter.Microsoft.Extensions.Logging" Version="$(UnoVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Uno.Extensions.Logging.WebAssembly.Console" Version="$(UnoExtensionsVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Microsoft.Extensions.Logging.Console" Version="$(MicrosoftExtensionsLoggingConsoleVersion)" IsImplicitlyDefined="true" />
    </ItemGroup>

    <ItemGroup Condition="'$(UseUnoWindows)' == 'true'">
        <PackageReference Include="Microsoft.WindowsAppSDK" Version="$(MicrosoftWindowsAppSDKVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Microsoft.Windows.SDK.BuildTools" Version="$(MicrosoftWindowsSDKBuildToolsVersion)" IsImplicitlyDefined="true" />
        <PackageReference Include="Microsoft.Extensions.Logging.Console" Version="$(MicrosoftExtensionsLoggingConsoleVersion)" IsImplicitlyDefined="true" />
    </ItemGroup>
    
</Project>